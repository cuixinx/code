[2024-12-03 16:09:32,378][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 16:09:32,383][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 16:09:32,505][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 16:09:36,676][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_16-09-32-343831
[2024-12-03 16:09:36,676][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 16:11:19,450][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 16:11:19,454][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 16:11:19,529][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 16:11:22,871][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\Office31_A\runs\2024-12-03_16-11-19-414296
[2024-12-03 16:11:22,872][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 16:13:55,710][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 16:13:55,713][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 16:13:55,790][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 16:13:56,094][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_16-13-55-675030
[2024-12-03 16:13:56,095][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 16:17:17,089][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 16:17:17,093][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 16:17:17,183][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 16:17:17,754][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_16-17-17-053000
[2024-12-03 16:17:17,755][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 16:17:50,111][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 16:17:50,116][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 16:17:50,190][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 16:17:50,496][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_16-17-50-076911
[2024-12-03 16:17:50,497][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 16:19:12,772][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 16:19:12,776][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 16:19:12,851][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 16:19:13,430][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_16-19-12-737009
[2024-12-03 16:19:13,431][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 16:19:55,735][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 16:19:55,740][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 16:19:55,817][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 16:20:04,010][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_16-19-55-699544
[2024-12-03 16:20:04,010][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 16:25:20,809][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 16:25:20,813][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 16:25:20,891][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 16:25:24,293][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_16-25-20-772999
[2024-12-03 16:25:24,293][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 16:27:45,233][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 16:27:45,238][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 16:27:45,315][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 16:27:45,636][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "D:\PyCharmProjects\improved_sfda\src\data\components\officehome.py", line 68, in __init__
    super(OfficeHome, self).__init__(root, OfficeHome.CLASSES, data_list_file=data_list_file, **kwargs)
  File "D:\PyCharmProjects\improved_sfda\src\data\components\imagelist.py", line 39, in __init__
    self.samples = self.parse_data_file(data_list_file)
  File "D:\PyCharmProjects\improved_sfda\src\data\components\imagelist.py", line 85, in parse_data_file
    with open(file_name, "r") as f:
FileNotFoundError: [Errno 2] No such file or directory: 'D:\\PyCharmProjects\\improved_sfda/data//officehome\\image_list/Art.txt'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 55, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.data.components.officehome.OfficeHome':
FileNotFoundError(2, 'No such file or directory')
full_key: data.dataset
[2024-12-03 16:27:45,646][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_16-27-45-197958
[2024-12-03 16:27:45,646][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 16:32:19,574][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 16:32:19,579][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 16:32:19,657][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 16:32:19,985][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-03 16:32:20,763][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-03 16:32:28,977][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-03 16:32:29,049][__main__][INFO] - Instantiating callbacks...
[2024-12-03 16:32:29,049][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-12-03 16:32:29,052][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\callbacks\model_checkpoint.py", line 241, in __init__
    self.__init_monitor_mode(mode)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\callbacks\model_checkpoint.py", line 445, in __init_monitor_mode
    torch_inf = torch.tensor(np.Inf)
  File "D:\anaconda3\envs\myenv\lib\site-packages\numpy\__init__.py", line 397, in __getattr__
    raise AttributeError(
AttributeError: `np.Inf` was removed in the NumPy 2.0 release. Use `np.inf` instead.. Did you mean: 'inf'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 61, in train
    callbacks: List[Callback] = utils.instantiate_callbacks(cfg.get("callbacks"))
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 108, in instantiate_callbacks
    callbacks.append(hydra.utils.instantiate(cb_conf))
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'lightning.pytorch.callbacks.model_checkpoint.ModelCheckpoint':
AttributeError('`np.Inf` was removed in the NumPy 2.0 release. Use `np.inf` instead.')
full_key: callbacks.model_checkpoint
[2024-12-03 16:32:29,064][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_16-32-19-539881
[2024-12-03 16:32:29,065][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 16:36:07,517][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 16:36:07,522][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 16:36:07,606][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 16:36:07,967][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-03 16:36:08,748][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-03 16:36:18,767][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-03 16:36:18,810][__main__][INFO] - Instantiating callbacks...
[2024-12-03 16:36:18,811][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-12-03 16:36:18,813][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-12-03 16:36:18,814][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-12-03 16:36:18,815][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-12-03 16:36:18,816][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.LearningRateMonitor>
[2024-12-03 16:36:18,817][__main__][INFO] - Instantiating loggers...
[2024-12-03 16:36:18,817][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-12-03 16:36:18,819][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.mlflow.MLFlowLogger>
[2024-12-03 16:36:18,822][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\registry.py", line 82, in get_store_builder
    store_builder = self._registry[scheme]
KeyError: 'd'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\loggers\mlflow.py", line 173, in __init__
    self._mlflow_client = MlflowClient(tracking_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\client.py", line 134, in __init__
    self._tracking_client = TrackingServiceClient(final_tracking_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\client.py", line 83, in __init__
    self.store
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\client.py", line 87, in store
    return utils._get_store(self.tracking_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\utils.py", line 208, in _get_store
    return _tracking_store_registry.get_store(store_uri, artifact_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\registry.py", line 45, in get_store
    return self._get_store_with_resolved_uri(resolved_store_uri, artifact_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\registry.py", line 55, in _get_store_with_resolved_uri
    builder = self.get_store_builder(resolved_store_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\registry.py", line 84, in get_store_builder
    raise UnsupportedModelRegistryStoreURIException(
mlflow.tracking.registry.UnsupportedModelRegistryStoreURIException:  Model registry functionality is unavailable; got unsupported URI 'D:\PyCharmProjects\improved_sfda/logs//mlflow/mlruns' for model registry data storage. Supported URI schemes are: ['', 'file', 'databricks', 'databricks-uc', 'uc', 'http', 'https', 'postgresql', 'mysql', 'sqlite', 'mssql']. See https://www.mlflow.org/docs/latest/tracking.html#storage for how to run an MLflow server against one of the supported backend storage locations.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 64, in train
    logger: List[Logger] = utils.instantiate_loggers(cfg.get("logger"))
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 127, in instantiate_loggers
    logger.append(hydra.utils.instantiate(lg_conf))
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'lightning.pytorch.loggers.mlflow.MLFlowLogger':
UnsupportedModelRegistryStoreURIException(" Model registry functionality is unavailable; got unsupported URI 'D:\\PyCharmProjects\\improved_sfda/logs//mlflow/mlruns' for model registry data storage. Supported URI schemes are: ['', 'file', 'databricks', 'databricks-uc', 'uc', 'http', 'https', 'postgresql', 'mysql', 'sqlite', 'mssql']. See https://www.mlflow.org/docs/latest/tracking.html#storage for how to run an MLflow server against one of the supported backend storage locations.")
full_key: logger.mlflow
[2024-12-03 16:36:18,883][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_16-36-07-480566
[2024-12-03 16:36:18,883][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 16:39:05,672][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 16:39:05,677][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 16:39:05,754][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 16:39:06,074][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-03 16:39:06,635][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-03 16:39:16,640][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-03 16:39:16,697][__main__][INFO] - Instantiating callbacks...
[2024-12-03 16:39:16,698][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-12-03 16:39:16,701][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-12-03 16:39:16,702][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-12-03 16:39:16,702][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-12-03 16:39:16,702][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.LearningRateMonitor>
[2024-12-03 16:39:16,703][__main__][INFO] - Instantiating loggers...
[2024-12-03 16:39:16,703][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-12-03 16:39:16,704][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.mlflow.MLFlowLogger>
[2024-12-03 16:39:16,708][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\registry.py", line 82, in get_store_builder
    store_builder = self._registry[scheme]
KeyError: 'd'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\loggers\mlflow.py", line 173, in __init__
    self._mlflow_client = MlflowClient(tracking_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\client.py", line 134, in __init__
    self._tracking_client = TrackingServiceClient(final_tracking_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\client.py", line 83, in __init__
    self.store
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\client.py", line 87, in store
    return utils._get_store(self.tracking_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\utils.py", line 208, in _get_store
    return _tracking_store_registry.get_store(store_uri, artifact_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\registry.py", line 45, in get_store
    return self._get_store_with_resolved_uri(resolved_store_uri, artifact_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\registry.py", line 55, in _get_store_with_resolved_uri
    builder = self.get_store_builder(resolved_store_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\registry.py", line 84, in get_store_builder
    raise UnsupportedModelRegistryStoreURIException(
mlflow.tracking.registry.UnsupportedModelRegistryStoreURIException:  Model registry functionality is unavailable; got unsupported URI 'D:\PyCharmProjects\improved_sfda/logs//mlflow/mlruns' for model registry data storage. Supported URI schemes are: ['', 'file', 'databricks', 'databricks-uc', 'uc', 'http', 'https', 'postgresql', 'mysql', 'sqlite', 'mssql']. See https://www.mlflow.org/docs/latest/tracking.html#storage for how to run an MLflow server against one of the supported backend storage locations.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 64, in train
    logger: List[Logger] = utils.instantiate_loggers(cfg.get("logger"))
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 127, in instantiate_loggers
    logger.append(hydra.utils.instantiate(lg_conf))
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'lightning.pytorch.loggers.mlflow.MLFlowLogger':
UnsupportedModelRegistryStoreURIException(" Model registry functionality is unavailable; got unsupported URI 'D:\\PyCharmProjects\\improved_sfda/logs//mlflow/mlruns' for model registry data storage. Supported URI schemes are: ['', 'file', 'databricks', 'databricks-uc', 'uc', 'http', 'https', 'postgresql', 'mysql', 'sqlite', 'mssql']. See https://www.mlflow.org/docs/latest/tracking.html#storage for how to run an MLflow server against one of the supported backend storage locations.")
full_key: logger.mlflow
[2024-12-03 16:39:16,712][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_16-39-05-637780
[2024-12-03 16:39:16,712][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 16:41:07,318][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 16:41:07,323][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 16:41:07,400][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 16:41:07,709][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "D:\PyCharmProjects\improved_sfda\src\data\components\officehome.py", line 68, in __init__
    super(OfficeHome, self).__init__(root, OfficeHome.CLASSES, data_list_file=data_list_file, **kwargs)
  File "D:\PyCharmProjects\improved_sfda\src\data\components\imagelist.py", line 39, in __init__
    self.samples = self.parse_data_file(data_list_file)
  File "D:\PyCharmProjects\improved_sfda\src\data\components\imagelist.py", line 85, in parse_data_file
    with open(file_name, "r") as f:
OSError: [Errno 22] Invalid argument: 'file://D:\\PyCharmProjects\\improved_sfda/data//officehome\\image_list/Art.txt'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 55, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.data.components.officehome.OfficeHome':
OSError(22, 'Invalid argument')
full_key: data.dataset
[2024-12-03 16:41:07,710][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_16-41-07-273861
[2024-12-03 16:41:07,711][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 16:41:40,574][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 16:41:40,579][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 16:41:40,659][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 16:41:40,996][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-03 16:41:41,587][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-03 16:41:51,598][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-03 16:41:51,643][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "D:\PyCharmProjects\improved_sfda\src\models\basic_module.py", line 108, in __init__
    os.makedirs(os.path.dirname(self.save_path_net_state_dict), exist_ok=True)
  File "D:\anaconda3\envs\myenv\lib\os.py", line 215, in makedirs
    makedirs(head, exist_ok=exist_ok)
  File "D:\anaconda3\envs\myenv\lib\os.py", line 215, in makedirs
    makedirs(head, exist_ok=exist_ok)
  File "D:\anaconda3\envs\myenv\lib\os.py", line 215, in makedirs
    makedirs(head, exist_ok=exist_ok)
  [Previous line repeated 2 more times]
  File "D:\anaconda3\envs\myenv\lib\os.py", line 225, in makedirs
    mkdir(name, mode)
OSError: [WinError 123] 文件名、目录名或卷标语法不正确。: 'file:'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 58, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.basic_module.BasicLitModule':
OSError(22, '文件名、目录名或卷标语法不正确。')
full_key: model
[2024-12-03 16:41:51,655][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_16-41-40-537869
[2024-12-03 16:41:51,655][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 16:42:15,951][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 16:42:15,956][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 16:42:16,048][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 16:42:16,379][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-03 16:42:16,956][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-03 16:42:26,963][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-03 16:42:27,015][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "D:\PyCharmProjects\improved_sfda\src\models\basic_module.py", line 108, in __init__
    os.makedirs(os.path.dirname(self.save_path_net_state_dict), exist_ok=True)
  File "D:\anaconda3\envs\myenv\lib\os.py", line 215, in makedirs
    makedirs(head, exist_ok=exist_ok)
  File "D:\anaconda3\envs\myenv\lib\os.py", line 215, in makedirs
    makedirs(head, exist_ok=exist_ok)
  File "D:\anaconda3\envs\myenv\lib\os.py", line 215, in makedirs
    makedirs(head, exist_ok=exist_ok)
  [Previous line repeated 2 more times]
  File "D:\anaconda3\envs\myenv\lib\os.py", line 225, in makedirs
    mkdir(name, mode)
OSError: [WinError 123] 文件名、目录名或卷标语法不正确。: 'file:'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 58, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.basic_module.BasicLitModule':
OSError(22, '文件名、目录名或卷标语法不正确。')
full_key: model
[2024-12-03 16:42:27,018][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_16-42-15-914547
[2024-12-03 16:42:27,019][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 16:42:41,033][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 16:42:41,037][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 16:42:41,116][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 16:42:41,444][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-03 16:42:42,009][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-03 16:42:52,015][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-03 16:42:52,062][__main__][INFO] - Instantiating callbacks...
[2024-12-03 16:42:52,062][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-12-03 16:42:52,065][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-12-03 16:42:52,066][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-12-03 16:42:52,067][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-12-03 16:42:52,068][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.LearningRateMonitor>
[2024-12-03 16:42:52,069][__main__][INFO] - Instantiating loggers...
[2024-12-03 16:42:52,069][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-12-03 16:42:52,071][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.mlflow.MLFlowLogger>
[2024-12-03 16:42:52,074][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\registry.py", line 82, in get_store_builder
    store_builder = self._registry[scheme]
KeyError: 'd'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\loggers\mlflow.py", line 173, in __init__
    self._mlflow_client = MlflowClient(tracking_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\client.py", line 134, in __init__
    self._tracking_client = TrackingServiceClient(final_tracking_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\client.py", line 83, in __init__
    self.store
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\client.py", line 87, in store
    return utils._get_store(self.tracking_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\utils.py", line 208, in _get_store
    return _tracking_store_registry.get_store(store_uri, artifact_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\registry.py", line 45, in get_store
    return self._get_store_with_resolved_uri(resolved_store_uri, artifact_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\registry.py", line 55, in _get_store_with_resolved_uri
    builder = self.get_store_builder(resolved_store_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\registry.py", line 84, in get_store_builder
    raise UnsupportedModelRegistryStoreURIException(
mlflow.tracking.registry.UnsupportedModelRegistryStoreURIException:  Model registry functionality is unavailable; got unsupported URI 'D:\PyCharmProjects\improved_sfda/logs//mlflow/mlruns' for model registry data storage. Supported URI schemes are: ['', 'file', 'databricks', 'databricks-uc', 'uc', 'http', 'https', 'postgresql', 'mysql', 'sqlite', 'mssql']. See https://www.mlflow.org/docs/latest/tracking.html#storage for how to run an MLflow server against one of the supported backend storage locations.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 64, in train
    logger: List[Logger] = utils.instantiate_loggers(cfg.get("logger"))
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 127, in instantiate_loggers
    logger.append(hydra.utils.instantiate(lg_conf))
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'lightning.pytorch.loggers.mlflow.MLFlowLogger':
UnsupportedModelRegistryStoreURIException(" Model registry functionality is unavailable; got unsupported URI 'D:\\PyCharmProjects\\improved_sfda/logs//mlflow/mlruns' for model registry data storage. Supported URI schemes are: ['', 'file', 'databricks', 'databricks-uc', 'uc', 'http', 'https', 'postgresql', 'mysql', 'sqlite', 'mssql']. See https://www.mlflow.org/docs/latest/tracking.html#storage for how to run an MLflow server against one of the supported backend storage locations.")
full_key: logger.mlflow
[2024-12-03 16:42:52,078][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_16-42-40-996414
[2024-12-03 16:42:52,078][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 16:46:26,935][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 16:46:26,940][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 16:46:27,026][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 16:46:27,373][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-03 16:46:27,952][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-03 16:46:37,957][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-03 16:46:38,005][__main__][INFO] - Instantiating callbacks...
[2024-12-03 16:46:38,005][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-12-03 16:46:38,008][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-12-03 16:46:38,009][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-12-03 16:46:38,010][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-12-03 16:46:38,011][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.LearningRateMonitor>
[2024-12-03 16:46:38,012][__main__][INFO] - Instantiating loggers...
[2024-12-03 16:46:38,012][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-12-03 16:46:38,014][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.mlflow.MLFlowLogger>
[2024-12-03 16:46:38,016][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\registry.py", line 82, in get_store_builder
    store_builder = self._registry[scheme]
KeyError: 'd'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\loggers\mlflow.py", line 173, in __init__
    self._mlflow_client = MlflowClient(tracking_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\client.py", line 134, in __init__
    self._tracking_client = TrackingServiceClient(final_tracking_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\client.py", line 83, in __init__
    self.store
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\client.py", line 87, in store
    return utils._get_store(self.tracking_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\utils.py", line 208, in _get_store
    return _tracking_store_registry.get_store(store_uri, artifact_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\registry.py", line 45, in get_store
    return self._get_store_with_resolved_uri(resolved_store_uri, artifact_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\registry.py", line 55, in _get_store_with_resolved_uri
    builder = self.get_store_builder(resolved_store_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\registry.py", line 84, in get_store_builder
    raise UnsupportedModelRegistryStoreURIException(
mlflow.tracking.registry.UnsupportedModelRegistryStoreURIException:  Model registry functionality is unavailable; got unsupported URI 'D:\PyCharmProjects\improved_sfda/logs//mlflow/mlruns' for model registry data storage. Supported URI schemes are: ['', 'file', 'databricks', 'databricks-uc', 'uc', 'http', 'https', 'postgresql', 'mysql', 'sqlite', 'mssql']. See https://www.mlflow.org/docs/latest/tracking.html#storage for how to run an MLflow server against one of the supported backend storage locations.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 64, in train
    logger: List[Logger] = utils.instantiate_loggers(cfg.get("logger"))
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 127, in instantiate_loggers
    logger.append(hydra.utils.instantiate(lg_conf))
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'lightning.pytorch.loggers.mlflow.MLFlowLogger':
UnsupportedModelRegistryStoreURIException(" Model registry functionality is unavailable; got unsupported URI 'D:\\PyCharmProjects\\improved_sfda/logs//mlflow/mlruns' for model registry data storage. Supported URI schemes are: ['', 'file', 'databricks', 'databricks-uc', 'uc', 'http', 'https', 'postgresql', 'mysql', 'sqlite', 'mssql']. See https://www.mlflow.org/docs/latest/tracking.html#storage for how to run an MLflow server against one of the supported backend storage locations.")
full_key: logger.mlflow
[2024-12-03 16:46:38,020][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_16-46-26-900154
[2024-12-03 16:46:38,020][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 16:49:41,618][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 16:49:41,622][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 16:49:41,700][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 16:49:42,034][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-03 16:49:42,505][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-03 16:49:52,512][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-03 16:49:52,651][__main__][INFO] - Instantiating callbacks...
[2024-12-03 16:49:52,652][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-12-03 16:49:52,655][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-12-03 16:49:52,656][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-12-03 16:49:52,657][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-12-03 16:49:52,658][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.LearningRateMonitor>
[2024-12-03 16:49:52,659][__main__][INFO] - Instantiating loggers...
[2024-12-03 16:49:52,659][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-12-03 16:49:52,661][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.mlflow.MLFlowLogger>
[2024-12-03 16:49:52,665][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\registry.py", line 82, in get_store_builder
    store_builder = self._registry[scheme]
KeyError: 'd'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\loggers\mlflow.py", line 173, in __init__
    self._mlflow_client = MlflowClient(tracking_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\client.py", line 134, in __init__
    self._tracking_client = TrackingServiceClient(final_tracking_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\client.py", line 83, in __init__
    self.store
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\client.py", line 87, in store
    return utils._get_store(self.tracking_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\utils.py", line 208, in _get_store
    return _tracking_store_registry.get_store(store_uri, artifact_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\registry.py", line 45, in get_store
    return self._get_store_with_resolved_uri(resolved_store_uri, artifact_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\registry.py", line 55, in _get_store_with_resolved_uri
    builder = self.get_store_builder(resolved_store_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\registry.py", line 84, in get_store_builder
    raise UnsupportedModelRegistryStoreURIException(
mlflow.tracking.registry.UnsupportedModelRegistryStoreURIException:  Model registry functionality is unavailable; got unsupported URI 'D:\PyCharmProjects\improved_sfda/logs//mlflow/mlruns' for model registry data storage. Supported URI schemes are: ['', 'file', 'databricks', 'databricks-uc', 'uc', 'http', 'https', 'postgresql', 'mysql', 'sqlite', 'mssql']. See https://www.mlflow.org/docs/latest/tracking.html#storage for how to run an MLflow server against one of the supported backend storage locations.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 64, in train
    logger: List[Logger] = utils.instantiate_loggers(cfg.get("logger"))
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 127, in instantiate_loggers
    logger.append(hydra.utils.instantiate(lg_conf))
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'lightning.pytorch.loggers.mlflow.MLFlowLogger':
UnsupportedModelRegistryStoreURIException(" Model registry functionality is unavailable; got unsupported URI 'D:\\PyCharmProjects\\improved_sfda/logs//mlflow/mlruns' for model registry data storage. Supported URI schemes are: ['', 'file', 'databricks', 'databricks-uc', 'uc', 'http', 'https', 'postgresql', 'mysql', 'sqlite', 'mssql']. See https://www.mlflow.org/docs/latest/tracking.html#storage for how to run an MLflow server against one of the supported backend storage locations.")
full_key: logger.mlflow
[2024-12-03 16:49:52,669][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_16-49-41-583013
[2024-12-03 16:49:52,670][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 16:51:31,579][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 16:51:31,584][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 16:51:31,662][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 16:51:31,995][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-03 16:51:32,461][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-03 16:51:42,473][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-03 16:51:42,608][__main__][INFO] - Instantiating callbacks...
[2024-12-03 16:51:42,609][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-12-03 16:51:42,612][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-12-03 16:51:42,613][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-12-03 16:51:42,613][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-12-03 16:51:42,615][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.LearningRateMonitor>
[2024-12-03 16:51:42,615][__main__][INFO] - Instantiating loggers...
[2024-12-03 16:51:42,615][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-12-03 16:51:42,618][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.mlflow.MLFlowLogger>
[2024-12-03 16:51:42,622][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\registry.py", line 82, in get_store_builder
    store_builder = self._registry[scheme]
KeyError: 'd'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\loggers\mlflow.py", line 174, in __init__
    self._mlflow_client = MlflowClient(tracking_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\client.py", line 134, in __init__
    self._tracking_client = TrackingServiceClient(final_tracking_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\client.py", line 83, in __init__
    self.store
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\client.py", line 87, in store
    return utils._get_store(self.tracking_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\utils.py", line 208, in _get_store
    return _tracking_store_registry.get_store(store_uri, artifact_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\registry.py", line 45, in get_store
    return self._get_store_with_resolved_uri(resolved_store_uri, artifact_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\registry.py", line 55, in _get_store_with_resolved_uri
    builder = self.get_store_builder(resolved_store_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\registry.py", line 84, in get_store_builder
    raise UnsupportedModelRegistryStoreURIException(
mlflow.tracking.registry.UnsupportedModelRegistryStoreURIException:  Model registry functionality is unavailable; got unsupported URI 'D:\PyCharmProjects\improved_sfda/logs//mlflow/mlruns' for model registry data storage. Supported URI schemes are: ['', 'file', 'databricks', 'databricks-uc', 'uc', 'http', 'https', 'postgresql', 'mysql', 'sqlite', 'mssql']. See https://www.mlflow.org/docs/latest/tracking.html#storage for how to run an MLflow server against one of the supported backend storage locations.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 64, in train
    logger: List[Logger] = utils.instantiate_loggers(cfg.get("logger"))
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 127, in instantiate_loggers
    logger.append(hydra.utils.instantiate(lg_conf))
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'lightning.pytorch.loggers.mlflow.MLFlowLogger':
UnsupportedModelRegistryStoreURIException(" Model registry functionality is unavailable; got unsupported URI 'D:\\PyCharmProjects\\improved_sfda/logs//mlflow/mlruns' for model registry data storage. Supported URI schemes are: ['', 'file', 'databricks', 'databricks-uc', 'uc', 'http', 'https', 'postgresql', 'mysql', 'sqlite', 'mssql']. See https://www.mlflow.org/docs/latest/tracking.html#storage for how to run an MLflow server against one of the supported backend storage locations.")
full_key: logger.mlflow
[2024-12-03 16:51:42,626][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_16-51-31-543168
[2024-12-03 16:51:42,626][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 16:53:04,953][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 16:53:04,958][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 16:53:05,039][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 16:53:05,382][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-03 16:53:05,902][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-03 16:53:15,908][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-03 16:53:16,051][__main__][INFO] - Instantiating callbacks...
[2024-12-03 16:53:16,052][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-12-03 16:53:16,054][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-12-03 16:53:16,056][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-12-03 16:53:16,057][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-12-03 16:53:16,058][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.LearningRateMonitor>
[2024-12-03 16:53:16,058][__main__][INFO] - Instantiating loggers...
[2024-12-03 16:53:16,059][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-12-03 16:53:16,060][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.mlflow.MLFlowLogger>
[2024-12-03 16:53:16,066][__main__][INFO] - Instantiating trainer <lightning.Trainer>
[2024-12-03 16:53:16,072][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\utilities\argparse.py", line 69, in insert_env_defaults
    return fn(self, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 393, in __init__
    self._accelerator_connector = _AcceleratorConnector(
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\connectors\accelerator_connector.py", line 154, in __init__
    self._accelerator_flag = self._choose_gpu_accelerator_backend()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\connectors\accelerator_connector.py", line 368, in _choose_gpu_accelerator_backend
    raise MisconfigurationException("No supported gpu backend found!")
lightning.fabric.utilities.exceptions.MisconfigurationException: No supported gpu backend found!

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 67, in train
    trainer: Trainer = hydra.utils.instantiate(cfg.trainer, callbacks=callbacks, logger=logger)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'lightning.pytorch.trainer.trainer.Trainer':
MisconfigurationException('No supported gpu backend found!')
full_key: trainer
[2024-12-03 16:53:16,084][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_16-53-04-918657
[2024-12-03 16:53:16,085][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 17:02:28,258][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 17:02:28,263][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 17:02:28,370][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 17:02:28,378][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.data' has no attribute 'src_train_datamodule'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 650, in _locate
    obj = import_module(mod)
  File "D:\anaconda3\envs\myenv\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "D:\PyCharmProjects\improved_sfda\src\data\src_train_datamodule.py", line 3, in <module>
    from torchvision.transforms import transforms
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\__init__.py", line 10, in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils  # usort:skip
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\_meta_registrations.py", line 4, in <module>
    import torch._custom_ops
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_ops.py", line 4, in <module>
    from torch._custom_op.impl import (
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_op\impl.py", line 15, in <module>
    from torch.library import get_ctx
ImportError: cannot import name 'get_ctx' from 'torch.library' (D:\anaconda3\envs\myenv\lib\site-packages\torch\library.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.data.src_train_datamodule.SrcTrainDataModule':
ImportError("cannot import name 'get_ctx' from 'torch.library' (D:\\anaconda3\\envs\\myenv\\lib\\site-packages\\torch\\library.py)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 55, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.data.src_train_datamodule.SrcTrainDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: data
[2024-12-03 17:02:28,423][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_17-02-28-224443
[2024-12-03 17:02:28,423][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 17:04:38,049][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 17:04:38,053][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 17:04:38,129][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 17:04:38,136][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.data' has no attribute 'src_train_datamodule'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 650, in _locate
    obj = import_module(mod)
  File "D:\anaconda3\envs\myenv\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "D:\PyCharmProjects\improved_sfda\src\data\src_train_datamodule.py", line 3, in <module>
    from torchvision.transforms import transforms
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\__init__.py", line 10, in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils  # usort:skip
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\_meta_registrations.py", line 4, in <module>
    import torch._custom_ops
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_ops.py", line 4, in <module>
    from torch._custom_op.impl import (
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_op\impl.py", line 15, in <module>
    from torch.library import get_ctx
ImportError: cannot import name 'get_ctx' from 'torch.library' (D:\anaconda3\envs\myenv\lib\site-packages\torch\library.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.data.src_train_datamodule.SrcTrainDataModule':
ImportError("cannot import name 'get_ctx' from 'torch.library' (D:\\anaconda3\\envs\\myenv\\lib\\site-packages\\torch\\library.py)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 55, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.data.src_train_datamodule.SrcTrainDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: data
[2024-12-03 17:04:38,140][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_17-04-38-014737
[2024-12-03 17:04:38,140][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 17:06:16,607][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 17:06:16,611][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 17:06:16,689][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 17:06:16,696][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.data' has no attribute 'src_train_datamodule'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 650, in _locate
    obj = import_module(mod)
  File "D:\anaconda3\envs\myenv\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "D:\PyCharmProjects\improved_sfda\src\data\src_train_datamodule.py", line 3, in <module>
    from torchvision.transforms import transforms
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\__init__.py", line 10, in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils  # usort:skip
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\_meta_registrations.py", line 4, in <module>
    import torch._custom_ops
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_ops.py", line 4, in <module>
    from torch._custom_op.impl import (
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_op\impl.py", line 15, in <module>
    from torch.library import get_ctx
ImportError: cannot import name 'get_ctx' from 'torch.library' (D:\anaconda3\envs\myenv\lib\site-packages\torch\library.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.data.src_train_datamodule.SrcTrainDataModule':
ImportError("cannot import name 'get_ctx' from 'torch.library' (D:\\anaconda3\\envs\\myenv\\lib\\site-packages\\torch\\library.py)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 55, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.data.src_train_datamodule.SrcTrainDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: data
[2024-12-03 17:06:16,700][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_17-06-16-572774
[2024-12-03 17:06:16,700][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 17:09:52,251][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 17:09:52,259][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 17:09:52,343][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 17:09:54,897][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-03 17:09:55,924][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-03 17:10:05,937][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-03 17:10:06,082][__main__][INFO] - Instantiating callbacks...
[2024-12-03 17:10:06,083][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-12-03 17:10:06,086][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-12-03 17:10:06,087][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-12-03 17:10:06,088][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-12-03 17:10:06,089][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.LearningRateMonitor>
[2024-12-03 17:10:06,090][__main__][INFO] - Instantiating loggers...
[2024-12-03 17:10:06,090][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-12-03 17:10:06,092][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.mlflow.MLFlowLogger>
[2024-12-03 17:10:06,561][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\registry.py", line 82, in get_store_builder
    store_builder = self._registry[scheme]
KeyError: 'd'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\loggers\mlflow.py", line 152, in __init__
    self._mlflow_client = MlflowClient(tracking_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\client.py", line 134, in __init__
    self._tracking_client = TrackingServiceClient(final_tracking_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\client.py", line 83, in __init__
    self.store
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\client.py", line 87, in store
    return utils._get_store(self.tracking_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\utils.py", line 208, in _get_store
    return _tracking_store_registry.get_store(store_uri, artifact_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\registry.py", line 45, in get_store
    return self._get_store_with_resolved_uri(resolved_store_uri, artifact_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\registry.py", line 55, in _get_store_with_resolved_uri
    builder = self.get_store_builder(resolved_store_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\registry.py", line 84, in get_store_builder
    raise UnsupportedModelRegistryStoreURIException(
mlflow.tracking.registry.UnsupportedModelRegistryStoreURIException:  Model registry functionality is unavailable; got unsupported URI 'D:\PyCharmProjects\improved_sfda/logs//mlflow/mlruns' for model registry data storage. Supported URI schemes are: ['', 'file', 'databricks', 'databricks-uc', 'uc', 'http', 'https', 'postgresql', 'mysql', 'sqlite', 'mssql']. See https://www.mlflow.org/docs/latest/tracking.html#storage for how to run an MLflow server against one of the supported backend storage locations.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 64, in train
    logger: List[Logger] = utils.instantiate_loggers(cfg.get("logger"))
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 127, in instantiate_loggers
    logger.append(hydra.utils.instantiate(lg_conf))
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'lightning.pytorch.loggers.mlflow.MLFlowLogger':
UnsupportedModelRegistryStoreURIException(" Model registry functionality is unavailable; got unsupported URI 'D:\\PyCharmProjects\\improved_sfda/logs//mlflow/mlruns' for model registry data storage. Supported URI schemes are: ['', 'file', 'databricks', 'databricks-uc', 'uc', 'http', 'https', 'postgresql', 'mysql', 'sqlite', 'mssql']. See https://www.mlflow.org/docs/latest/tracking.html#storage for how to run an MLflow server against one of the supported backend storage locations.")
full_key: logger.mlflow
[2024-12-03 17:10:06,604][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_17-09-52-213025
[2024-12-03 17:10:06,604][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 17:11:14,038][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 17:11:14,045][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 17:11:14,125][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 17:11:14,883][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-03 17:11:15,654][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-03 17:11:25,661][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-03 17:11:25,702][__main__][INFO] - Instantiating callbacks...
[2024-12-03 17:11:25,703][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-12-03 17:11:25,707][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-12-03 17:11:25,709][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-12-03 17:11:25,710][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-12-03 17:11:25,712][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.LearningRateMonitor>
[2024-12-03 17:11:25,712][__main__][INFO] - Instantiating loggers...
[2024-12-03 17:11:25,713][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-12-03 17:11:25,715][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.mlflow.MLFlowLogger>
[2024-12-03 17:11:26,091][__main__][INFO] - Instantiating trainer <lightning.Trainer>
[2024-12-03 17:11:26,106][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\utilities\argparse.py", line 70, in insert_env_defaults
    return fn(self, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 395, in __init__
    self._accelerator_connector = _AcceleratorConnector(
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\connectors\accelerator_connector.py", line 143, in __init__
    self._accelerator_flag = self._choose_gpu_accelerator_backend()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\connectors\accelerator_connector.py", line 353, in _choose_gpu_accelerator_backend
    raise MisconfigurationException("No supported gpu backend found!")
lightning.fabric.utilities.exceptions.MisconfigurationException: No supported gpu backend found!

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 67, in train
    trainer: Trainer = hydra.utils.instantiate(cfg.trainer, callbacks=callbacks, logger=logger)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'lightning.pytorch.trainer.trainer.Trainer':
MisconfigurationException('No supported gpu backend found!')
full_key: trainer
[2024-12-03 17:11:26,108][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_17-11-14-002964
[2024-12-03 17:11:26,109][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 17:42:46,244][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 17:42:46,251][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 17:42:46,347][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 17:42:46,353][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.data' has no attribute 'src_train_datamodule'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 650, in _locate
    obj = import_module(mod)
  File "D:\anaconda3\envs\myenv\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "D:\PyCharmProjects\improved_sfda\src\data\src_train_datamodule.py", line 3, in <module>
    from torchvision.transforms import transforms
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\__init__.py", line 10, in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils  # usort:skip
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\_meta_registrations.py", line 4, in <module>
    import torch._custom_ops
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_ops.py", line 4, in <module>
    from torch._custom_op.impl import (
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_op\impl.py", line 15, in <module>
    from torch.library import get_ctx
ImportError: cannot import name 'get_ctx' from 'torch.library' (D:\anaconda3\envs\myenv\lib\site-packages\torch\library.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.data.src_train_datamodule.SrcTrainDataModule':
ImportError("cannot import name 'get_ctx' from 'torch.library' (D:\\anaconda3\\envs\\myenv\\lib\\site-packages\\torch\\library.py)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 55, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.data.src_train_datamodule.SrcTrainDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: data
[2024-12-03 17:42:46,376][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\Office31_A\runs\2024-12-03_17-42-46-209827
[2024-12-03 17:42:46,377][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 17:43:29,310][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 17:43:29,317][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 17:43:29,400][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 17:43:29,407][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.data' has no attribute 'src_train_datamodule'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 650, in _locate
    obj = import_module(mod)
  File "D:\anaconda3\envs\myenv\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "D:\PyCharmProjects\improved_sfda\src\data\src_train_datamodule.py", line 3, in <module>
    from torchvision.transforms import transforms
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\__init__.py", line 10, in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils  # usort:skip
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\_meta_registrations.py", line 4, in <module>
    import torch._custom_ops
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_ops.py", line 4, in <module>
    from torch._custom_op.impl import (
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_op\impl.py", line 15, in <module>
    from torch.library import get_ctx
ImportError: cannot import name 'get_ctx' from 'torch.library' (D:\anaconda3\envs\myenv\lib\site-packages\torch\library.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.data.src_train_datamodule.SrcTrainDataModule':
ImportError("cannot import name 'get_ctx' from 'torch.library' (D:\\anaconda3\\envs\\myenv\\lib\\site-packages\\torch\\library.py)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 55, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.data.src_train_datamodule.SrcTrainDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: data
[2024-12-03 17:43:29,410][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_17-43-29-275641
[2024-12-03 17:43:29,410][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 17:45:35,773][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 17:45:35,780][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 17:45:35,865][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 17:45:35,871][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.data' has no attribute 'src_train_datamodule'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 650, in _locate
    obj = import_module(mod)
  File "D:\anaconda3\envs\myenv\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "D:\PyCharmProjects\improved_sfda\src\data\src_train_datamodule.py", line 3, in <module>
    from torchvision.transforms import transforms
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\__init__.py", line 10, in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils  # usort:skip
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\_meta_registrations.py", line 4, in <module>
    import torch._custom_ops
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_ops.py", line 4, in <module>
    from torch._custom_op.impl import (
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_op\impl.py", line 15, in <module>
    from torch.library import get_ctx
ImportError: cannot import name 'get_ctx' from 'torch.library' (D:\anaconda3\envs\myenv\lib\site-packages\torch\library.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.data.src_train_datamodule.SrcTrainDataModule':
ImportError("cannot import name 'get_ctx' from 'torch.library' (D:\\anaconda3\\envs\\myenv\\lib\\site-packages\\torch\\library.py)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 55, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.data.src_train_datamodule.SrcTrainDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: data
[2024-12-03 17:45:35,875][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_17-45-35-738576
[2024-12-03 17:45:35,875][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 17:47:59,702][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 17:47:59,708][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 17:47:59,793][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 17:47:59,800][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.data' has no attribute 'src_train_datamodule'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 650, in _locate
    obj = import_module(mod)
  File "D:\anaconda3\envs\myenv\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "D:\PyCharmProjects\improved_sfda\src\data\src_train_datamodule.py", line 3, in <module>
    from torchvision.transforms import transforms
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\__init__.py", line 10, in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils  # usort:skip
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\_meta_registrations.py", line 4, in <module>
    import torch._custom_ops
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_ops.py", line 4, in <module>
    from torch._custom_op.impl import (
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_op\impl.py", line 15, in <module>
    from torch.library import get_ctx
ImportError: cannot import name 'get_ctx' from 'torch.library' (D:\anaconda3\envs\myenv\lib\site-packages\torch\library.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.data.src_train_datamodule.SrcTrainDataModule':
ImportError("cannot import name 'get_ctx' from 'torch.library' (D:\\anaconda3\\envs\\myenv\\lib\\site-packages\\torch\\library.py)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 55, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.data.src_train_datamodule.SrcTrainDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: data
[2024-12-03 17:47:59,802][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_17-47-59-666491
[2024-12-03 17:47:59,803][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 18:29:42,790][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 18:29:42,803][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 18:29:42,975][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 18:29:42,989][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.data' has no attribute 'src_train_datamodule'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 650, in _locate
    obj = import_module(mod)
  File "D:\anaconda3\envs\myenv\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "D:\PyCharmProjects\improved_sfda\src\data\src_train_datamodule.py", line 3, in <module>
    from torchvision.transforms import transforms
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\__init__.py", line 10, in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils  # usort:skip
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\_meta_registrations.py", line 4, in <module>
    import torch._custom_ops
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_ops.py", line 4, in <module>
    from torch._custom_op.impl import (
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_op\impl.py", line 15, in <module>
    from torch.library import get_ctx
ImportError: cannot import name 'get_ctx' from 'torch.library' (D:\anaconda3\envs\myenv\lib\site-packages\torch\library.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.data.src_train_datamodule.SrcTrainDataModule':
ImportError("cannot import name 'get_ctx' from 'torch.library' (D:\\anaconda3\\envs\\myenv\\lib\\site-packages\\torch\\library.py)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 55, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.data.src_train_datamodule.SrcTrainDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: data
[2024-12-03 18:29:42,997][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_18-29-42-719497
[2024-12-03 18:29:42,998][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 18:30:44,896][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 18:30:44,905][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 18:30:45,007][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 18:30:45,014][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.data' has no attribute 'src_train_datamodule'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 650, in _locate
    obj = import_module(mod)
  File "D:\anaconda3\envs\myenv\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "D:\PyCharmProjects\improved_sfda\src\data\src_train_datamodule.py", line 3, in <module>
    from torchvision.transforms import transforms
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\__init__.py", line 10, in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils  # usort:skip
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\_meta_registrations.py", line 4, in <module>
    import torch._custom_ops
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_ops.py", line 4, in <module>
    from torch._custom_op.impl import (
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_op\impl.py", line 15, in <module>
    from torch.library import get_ctx
ImportError: cannot import name 'get_ctx' from 'torch.library' (D:\anaconda3\envs\myenv\lib\site-packages\torch\library.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.data.src_train_datamodule.SrcTrainDataModule':
ImportError("cannot import name 'get_ctx' from 'torch.library' (D:\\anaconda3\\envs\\myenv\\lib\\site-packages\\torch\\library.py)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 55, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.data.src_train_datamodule.SrcTrainDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: data
[2024-12-03 18:30:45,018][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_18-30-44-854500
[2024-12-03 18:30:45,018][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 18:32:05,134][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 18:32:05,147][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 18:32:05,321][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 18:32:05,338][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.data' has no attribute 'src_train_datamodule'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 650, in _locate
    obj = import_module(mod)
  File "D:\anaconda3\envs\myenv\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "D:\PyCharmProjects\improved_sfda\src\data\src_train_datamodule.py", line 3, in <module>
    from torchvision.transforms import transforms
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\__init__.py", line 10, in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils  # usort:skip
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\_meta_registrations.py", line 4, in <module>
    import torch._custom_ops
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_ops.py", line 4, in <module>
    from torch._custom_op.impl import (
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_op\impl.py", line 15, in <module>
    from torch.library import get_ctx
ImportError: cannot import name 'get_ctx' from 'torch.library' (D:\anaconda3\envs\myenv\lib\site-packages\torch\library.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.data.src_train_datamodule.SrcTrainDataModule':
ImportError("cannot import name 'get_ctx' from 'torch.library' (D:\\anaconda3\\envs\\myenv\\lib\\site-packages\\torch\\library.py)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 55, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.data.src_train_datamodule.SrcTrainDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: data
[2024-12-03 18:32:05,345][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_18-32-05-063853
[2024-12-03 18:32:05,347][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 18:32:57,755][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 18:32:57,774][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 18:32:57,964][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 18:32:57,976][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.data' has no attribute 'src_train_datamodule'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 650, in _locate
    obj = import_module(mod)
  File "D:\anaconda3\envs\myenv\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "D:\PyCharmProjects\improved_sfda\src\data\src_train_datamodule.py", line 3, in <module>
    from torchvision.transforms import transforms
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\__init__.py", line 10, in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils  # usort:skip
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\_meta_registrations.py", line 4, in <module>
    import torch._custom_ops
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_ops.py", line 4, in <module>
    from torch._custom_op.impl import (
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_op\impl.py", line 15, in <module>
    from torch.library import get_ctx
ImportError: cannot import name 'get_ctx' from 'torch.library' (D:\anaconda3\envs\myenv\lib\site-packages\torch\library.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.data.src_train_datamodule.SrcTrainDataModule':
ImportError("cannot import name 'get_ctx' from 'torch.library' (D:\\anaconda3\\envs\\myenv\\lib\\site-packages\\torch\\library.py)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 55, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.data.src_train_datamodule.SrcTrainDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: data
[2024-12-03 18:32:57,982][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_18-32-57-689099
[2024-12-03 18:32:57,983][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 18:35:06,655][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 18:35:06,663][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 18:35:06,763][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 18:35:06,770][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.data' has no attribute 'src_train_datamodule'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 650, in _locate
    obj = import_module(mod)
  File "D:\anaconda3\envs\myenv\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "D:\PyCharmProjects\improved_sfda\src\data\src_train_datamodule.py", line 3, in <module>
    from torchvision.transforms import transforms
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\__init__.py", line 10, in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils  # usort:skip
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\_meta_registrations.py", line 4, in <module>
    import torch._custom_ops
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_ops.py", line 11, in <module>
    from torch.library import get_ctx
ImportError: cannot import name 'get_ctx' from 'torch.library' (D:\anaconda3\envs\myenv\lib\site-packages\torch\library.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.data.src_train_datamodule.SrcTrainDataModule':
ImportError("cannot import name 'get_ctx' from 'torch.library' (D:\\anaconda3\\envs\\myenv\\lib\\site-packages\\torch\\library.py)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 56, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.data.src_train_datamodule.SrcTrainDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: data
[2024-12-03 18:35:06,774][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_18-35-06-617038
[2024-12-03 18:35:06,774][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 18:39:05,864][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 18:39:05,880][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 18:39:05,968][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 18:39:05,974][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.data' has no attribute 'src_train_datamodule'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 650, in _locate
    obj = import_module(mod)
  File "D:\anaconda3\envs\myenv\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "D:\PyCharmProjects\improved_sfda\src\data\src_train_datamodule.py", line 3, in <module>
    from torchvision.transforms import transforms
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\__init__.py", line 10, in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils  # usort:skip
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\_meta_registrations.py", line 4, in <module>
    import torch._custom_ops
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_ops.py", line 4, in <module>
    from torch._custom_op.impl import (
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_op\impl.py", line 15, in <module>
    from torch.library import get_ctx
ImportError: cannot import name 'get_ctx' from 'torch.library' (D:\anaconda3\envs\myenv\lib\site-packages\torch\library.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.data.src_train_datamodule.SrcTrainDataModule':
ImportError("cannot import name 'get_ctx' from 'torch.library' (D:\\anaconda3\\envs\\myenv\\lib\\site-packages\\torch\\library.py)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 56, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.data.src_train_datamodule.SrcTrainDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: data
[2024-12-03 18:39:05,978][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_18-39-05-829857
[2024-12-03 18:39:05,978][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 18:41:35,908][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 18:41:35,914][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 18:41:35,999][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 18:41:36,006][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.data' has no attribute 'src_train_datamodule'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 650, in _locate
    obj = import_module(mod)
  File "D:\anaconda3\envs\myenv\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "D:\PyCharmProjects\improved_sfda\src\data\src_train_datamodule.py", line 3, in <module>
    from torchvision.transforms import transforms
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\__init__.py", line 10, in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils  # usort:skip
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\_meta_registrations.py", line 4, in <module>
    import torch._custom_ops
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_ops.py", line 4, in <module>
    from torch._custom_op.impl import (
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_op\impl.py", line 15, in <module>
    from torch.library import get_ctx
ImportError: cannot import name 'get_ctx' from 'torch.library' (D:\anaconda3\envs\myenv\lib\site-packages\torch\library.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.data.src_train_datamodule.SrcTrainDataModule':
ImportError("cannot import name 'get_ctx' from 'torch.library' (D:\\anaconda3\\envs\\myenv\\lib\\site-packages\\torch\\library.py)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 56, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.data.src_train_datamodule.SrcTrainDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: data
[2024-12-03 18:41:36,009][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_18-41-35-863238
[2024-12-03 18:41:36,010][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 18:42:16,997][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 18:42:17,007][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 18:42:17,585][__main__][INFO] - Instantiating datamodule <src.data.tgt_train_datamodule.TgtTrainDataModule>
[2024-12-03 18:42:17,604][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.data' has no attribute 'tgt_train_datamodule'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 650, in _locate
    obj = import_module(mod)
  File "D:\anaconda3\envs\myenv\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "D:\PyCharmProjects\improved_sfda\src\data\tgt_train_datamodule.py", line 3, in <module>
    from torchvision.transforms import transforms
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\__init__.py", line 10, in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils  # usort:skip
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\_meta_registrations.py", line 4, in <module>
    import torch._custom_ops
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_ops.py", line 4, in <module>
    from torch._custom_op.impl import (
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_custom_op\impl.py", line 15, in <module>
    from torch.library import get_ctx
ImportError: cannot import name 'get_ctx' from 'torch.library' (D:\anaconda3\envs\myenv\lib\site-packages\torch\library.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.data.tgt_train_datamodule.TgtTrainDataModule':
ImportError("cannot import name 'get_ctx' from 'torch.library' (D:\\anaconda3\\envs\\myenv\\lib\\site-packages\\torch\\library.py)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 56, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.data.tgt_train_datamodule.TgtTrainDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: data
[2024-12-03 18:42:17,609][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\Office31_A2D\runs\2024-12-03_18-42-16-911328
[2024-12-03 18:42:17,609][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 18:49:34,123][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 18:49:34,130][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 18:49:34,255][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 18:49:38,474][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\Office31_A\runs\2024-12-03_18-49-34-086583
[2024-12-03 18:49:38,474][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 18:50:07,900][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 18:50:07,906][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 18:50:07,988][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 18:50:08,724][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-03 18:50:09,453][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-03 18:50:19,471][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-03 18:50:19,594][__main__][INFO] - Instantiating callbacks...
[2024-12-03 18:50:19,595][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-12-03 18:50:19,598][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-12-03 18:50:19,599][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-12-03 18:50:19,600][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-12-03 18:50:19,601][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.LearningRateMonitor>
[2024-12-03 18:50:19,602][__main__][INFO] - Instantiating loggers...
[2024-12-03 18:50:19,602][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-12-03 18:50:19,604][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.mlflow.MLFlowLogger>
[2024-12-03 18:50:20,774][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\registry.py", line 82, in get_store_builder
    store_builder = self._registry[scheme]
KeyError: 'd'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\loggers\mlflow.py", line 152, in __init__
    self._mlflow_client = MlflowClient(tracking_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\client.py", line 134, in __init__
    self._tracking_client = TrackingServiceClient(final_tracking_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\client.py", line 83, in __init__
    self.store
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\client.py", line 87, in store
    return utils._get_store(self.tracking_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\utils.py", line 208, in _get_store
    return _tracking_store_registry.get_store(store_uri, artifact_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\registry.py", line 45, in get_store
    return self._get_store_with_resolved_uri(resolved_store_uri, artifact_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\_tracking_service\registry.py", line 55, in _get_store_with_resolved_uri
    builder = self.get_store_builder(resolved_store_uri)
  File "D:\anaconda3\envs\myenv\lib\site-packages\mlflow\tracking\registry.py", line 84, in get_store_builder
    raise UnsupportedModelRegistryStoreURIException(
mlflow.tracking.registry.UnsupportedModelRegistryStoreURIException:  Model registry functionality is unavailable; got unsupported URI 'D:\PyCharmProjects\improved_sfda/logs//mlflow/mlruns' for model registry data storage. Supported URI schemes are: ['', 'file', 'databricks', 'databricks-uc', 'uc', 'http', 'https', 'postgresql', 'mysql', 'sqlite', 'mssql']. See https://www.mlflow.org/docs/latest/tracking.html#storage for how to run an MLflow server against one of the supported backend storage locations.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 65, in train
    logger: List[Logger] = utils.instantiate_loggers(cfg.get("logger"))
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 127, in instantiate_loggers
    logger.append(hydra.utils.instantiate(lg_conf))
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'lightning.pytorch.loggers.mlflow.MLFlowLogger':
UnsupportedModelRegistryStoreURIException(" Model registry functionality is unavailable; got unsupported URI 'D:\\PyCharmProjects\\improved_sfda/logs//mlflow/mlruns' for model registry data storage. Supported URI schemes are: ['', 'file', 'databricks', 'databricks-uc', 'uc', 'http', 'https', 'postgresql', 'mysql', 'sqlite', 'mssql']. See https://www.mlflow.org/docs/latest/tracking.html#storage for how to run an MLflow server against one of the supported backend storage locations.")
full_key: logger.mlflow
[2024-12-03 18:50:20,832][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_18-50-07-865415
[2024-12-03 18:50:20,833][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 18:51:54,263][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 18:51:54,270][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 18:51:54,352][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 18:51:55,074][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-03 18:51:55,588][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-03 18:52:05,595][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-03 18:52:05,638][__main__][INFO] - Instantiating callbacks...
[2024-12-03 18:52:05,638][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-12-03 18:52:05,642][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-12-03 18:52:05,643][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-12-03 18:52:05,644][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-12-03 18:52:05,645][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.LearningRateMonitor>
[2024-12-03 18:52:05,645][__main__][INFO] - Instantiating loggers...
[2024-12-03 18:52:05,646][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-12-03 18:52:05,647][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.mlflow.MLFlowLogger>
[2024-12-03 18:52:06,098][__main__][INFO] - Instantiating trainer <lightning.Trainer>
[2024-12-03 18:52:06,103][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\utilities\argparse.py", line 70, in insert_env_defaults
    return fn(self, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 395, in __init__
    self._accelerator_connector = _AcceleratorConnector(
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\connectors\accelerator_connector.py", line 143, in __init__
    self._accelerator_flag = self._choose_gpu_accelerator_backend()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\connectors\accelerator_connector.py", line 353, in _choose_gpu_accelerator_backend
    raise MisconfigurationException("No supported gpu backend found!")
lightning.fabric.utilities.exceptions.MisconfigurationException: No supported gpu backend found!

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 68, in train
    trainer: Trainer = hydra.utils.instantiate(cfg.trainer, callbacks=callbacks, logger=logger)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'lightning.pytorch.trainer.trainer.Trainer':
MisconfigurationException('No supported gpu backend found!')
full_key: trainer
[2024-12-03 18:52:06,133][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_18-51-54-228344
[2024-12-03 18:52:06,133][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 18:53:51,604][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 18:53:51,611][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 18:53:51,702][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 18:53:52,437][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-03 18:53:52,992][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-03 18:54:02,997][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-03 18:54:03,049][__main__][INFO] - Instantiating callbacks...
[2024-12-03 18:54:03,049][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-12-03 18:54:03,053][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-12-03 18:54:03,055][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-12-03 18:54:03,056][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-12-03 18:54:03,057][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.LearningRateMonitor>
[2024-12-03 18:54:03,057][__main__][INFO] - Instantiating loggers...
[2024-12-03 18:54:03,058][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-12-03 18:54:03,060][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.mlflow.MLFlowLogger>
[2024-12-03 18:54:03,507][__main__][INFO] - Instantiating trainer <lightning.Trainer>
[2024-12-03 18:54:03,558][__main__][INFO] - Logging hyperparameters!
[2024-12-03 18:54:04,260][__main__][INFO] - Starting training!
[2024-12-03 18:54:23,087][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 85, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 538, in fit
    call._call_and_handle_interrupt(
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 574, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 981, in _run
    results = self._run_stage()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 1023, in _run_stage
    self._run_sanity_check()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 1052, in _run_sanity_check
    val_loop.run()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\loops\utilities.py", line 178, in _decorator
    return loop_run(self, *args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\loops\evaluation_loop.py", line 128, in run
    batch, batch_idx, dataloader_idx = next(data_fetcher)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\loops\fetchers.py", line 133, in __next__
    batch = super().__next__()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\loops\fetchers.py", line 60, in __next__
    batch = next(self.iterator)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\utilities\combined_loader.py", line 341, in __next__
    out = next(self._iterator)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\utilities\combined_loader.py", line 142, in __next__
    out = next(self.iterators[0])
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\utils\data\dataloader.py", line 634, in __next__
    data = self._next_data()
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\utils\data\dataloader.py", line 1346, in _next_data
    return self._process_data(data)
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\utils\data\dataloader.py", line 1372, in _process_data
    data.reraise()
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_utils.py", line 644, in reraise
    raise exception
FileNotFoundError: Caught FileNotFoundError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\utils\data\_utils\worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\utils\data\_utils\fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\utils\data\_utils\fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "D:\PyCharmProjects\improved_sfda\src\data\components\imagelist.py", line 60, in __getitem__
    img = self.loader(path)
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\datasets\folder.py", line 268, in default_loader
    return pil_loader(path)
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\datasets\folder.py", line 246, in pil_loader
    with open(path, "rb") as f:
FileNotFoundError: [Errno 2] No such file or directory: 'D:\\PyCharmProjects\\improved_sfda/data//officehome\\data/officehome\\Art\\Screwdriver\\00016.jpg'

[2024-12-03 18:54:23,138][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_18-53-51-570346
[2024-12-03 18:54:23,138][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 18:57:37,627][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 18:57:37,634][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 18:57:37,716][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 18:57:38,440][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-03 18:57:38,952][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-03 18:57:48,976][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-03 18:57:49,031][__main__][INFO] - Instantiating callbacks...
[2024-12-03 18:57:49,031][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-12-03 18:57:49,034][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-12-03 18:57:49,035][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-12-03 18:57:49,036][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-12-03 18:57:49,037][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.LearningRateMonitor>
[2024-12-03 18:57:49,038][__main__][INFO] - Instantiating loggers...
[2024-12-03 18:57:49,038][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-12-03 18:57:49,040][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.mlflow.MLFlowLogger>
[2024-12-03 18:57:49,499][__main__][INFO] - Instantiating trainer <lightning.Trainer>
[2024-12-03 18:57:49,548][__main__][INFO] - Logging hyperparameters!
[2024-12-03 18:57:49,983][__main__][INFO] - Starting training!
[2024-12-03 18:58:09,400][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 85, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 538, in fit
    call._call_and_handle_interrupt(
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 574, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 981, in _run
    results = self._run_stage()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 1023, in _run_stage
    self._run_sanity_check()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 1052, in _run_sanity_check
    val_loop.run()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\loops\utilities.py", line 178, in _decorator
    return loop_run(self, *args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\loops\evaluation_loop.py", line 128, in run
    batch, batch_idx, dataloader_idx = next(data_fetcher)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\loops\fetchers.py", line 133, in __next__
    batch = super().__next__()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\loops\fetchers.py", line 60, in __next__
    batch = next(self.iterator)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\utilities\combined_loader.py", line 341, in __next__
    out = next(self._iterator)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\utilities\combined_loader.py", line 142, in __next__
    out = next(self.iterators[0])
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\utils\data\dataloader.py", line 634, in __next__
    data = self._next_data()
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\utils\data\dataloader.py", line 1346, in _next_data
    return self._process_data(data)
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\utils\data\dataloader.py", line 1372, in _process_data
    data.reraise()
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_utils.py", line 644, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\utils\data\_utils\worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\utils\data\_utils\fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\utils\data\_utils\fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "D:\PyCharmProjects\improved_sfda\src\data\components\imagelist.py", line 63, in __getitem__
    img_a = self.transform(img)
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\transforms\transforms.py", line 95, in __call__
    img = t(img)
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\transforms\transforms.py", line 137, in __call__
    return F.to_tensor(pic)
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\transforms\functional.py", line 166, in to_tensor
    img = torch.from_numpy(np.array(pic, mode_to_nptype.get(pic.mode, np.uint8), copy=True))
RuntimeError: Numpy is not available

[2024-12-03 18:58:09,404][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_18-57-37-593521
[2024-12-03 18:58:09,404][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 19:03:52,273][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 19:03:52,280][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 19:03:52,363][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 19:03:53,111][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-03 19:03:53,637][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-03 19:04:03,646][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-03 19:04:03,686][__main__][INFO] - Instantiating callbacks...
[2024-12-03 19:04:03,687][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-12-03 19:04:03,690][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-12-03 19:04:03,691][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-12-03 19:04:03,692][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-12-03 19:04:03,693][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.LearningRateMonitor>
[2024-12-03 19:04:03,693][__main__][INFO] - Instantiating loggers...
[2024-12-03 19:04:03,693][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-12-03 19:04:03,695][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.mlflow.MLFlowLogger>
[2024-12-03 19:04:04,104][__main__][INFO] - Instantiating trainer <lightning.Trainer>
[2024-12-03 19:04:04,151][__main__][INFO] - Logging hyperparameters!
[2024-12-03 19:04:04,649][__main__][INFO] - Starting training!
[2024-12-03 19:04:24,043][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 85, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 538, in fit
    call._call_and_handle_interrupt(
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 574, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 981, in _run
    results = self._run_stage()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 1023, in _run_stage
    self._run_sanity_check()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 1052, in _run_sanity_check
    val_loop.run()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\loops\utilities.py", line 178, in _decorator
    return loop_run(self, *args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\loops\evaluation_loop.py", line 128, in run
    batch, batch_idx, dataloader_idx = next(data_fetcher)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\loops\fetchers.py", line 133, in __next__
    batch = super().__next__()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\loops\fetchers.py", line 60, in __next__
    batch = next(self.iterator)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\utilities\combined_loader.py", line 341, in __next__
    out = next(self._iterator)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\utilities\combined_loader.py", line 142, in __next__
    out = next(self.iterators[0])
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\utils\data\dataloader.py", line 634, in __next__
    data = self._next_data()
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\utils\data\dataloader.py", line 1346, in _next_data
    return self._process_data(data)
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\utils\data\dataloader.py", line 1372, in _process_data
    data.reraise()
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\_utils.py", line 644, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\utils\data\_utils\worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\utils\data\_utils\fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "D:\anaconda3\envs\myenv\lib\site-packages\torch\utils\data\_utils\fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "D:\PyCharmProjects\improved_sfda\src\data\components\imagelist.py", line 63, in __getitem__
    img_a = self.transform(img)
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\transforms\transforms.py", line 95, in __call__
    img = t(img)
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\transforms\transforms.py", line 137, in __call__
    return F.to_tensor(pic)
  File "D:\anaconda3\envs\myenv\lib\site-packages\torchvision\transforms\functional.py", line 166, in to_tensor
    img = torch.from_numpy(np.array(pic, mode_to_nptype.get(pic.mode, np.uint8), copy=True))
RuntimeError: Numpy is not available

[2024-12-03 19:04:24,047][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_19-03-52-239264
[2024-12-03 19:04:24,047][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 19:06:59,653][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 19:06:59,661][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 19:06:59,736][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 19:07:00,453][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-03 19:07:01,008][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-03 19:07:11,019][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-03 19:07:11,054][__main__][INFO] - Instantiating callbacks...
[2024-12-03 19:07:11,055][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-12-03 19:07:11,058][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-12-03 19:07:11,059][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-12-03 19:07:11,060][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-12-03 19:07:11,061][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.LearningRateMonitor>
[2024-12-03 19:07:11,062][__main__][INFO] - Instantiating loggers...
[2024-12-03 19:07:11,062][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-12-03 19:07:11,064][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.mlflow.MLFlowLogger>
[2024-12-03 19:07:11,454][__main__][INFO] - Instantiating trainer <lightning.Trainer>
[2024-12-03 19:07:11,516][__main__][INFO] - Logging hyperparameters!
[2024-12-03 19:07:12,018][__main__][INFO] - Starting training!
[2024-12-03 19:08:27,691][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_19-06-59-615682
[2024-12-03 19:08:27,693][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 19:08:44,657][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 19:08:44,664][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 19:08:44,742][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 19:08:46,037][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-03 19:08:46,643][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-03 19:08:56,661][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-03 19:08:56,786][__main__][INFO] - Instantiating callbacks...
[2024-12-03 19:08:56,786][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-12-03 19:08:56,789][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-12-03 19:08:56,790][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-12-03 19:08:56,791][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-12-03 19:08:56,792][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.LearningRateMonitor>
[2024-12-03 19:08:56,793][__main__][INFO] - Instantiating loggers...
[2024-12-03 19:08:56,793][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-12-03 19:08:56,795][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.mlflow.MLFlowLogger>
[2024-12-03 19:08:57,270][__main__][INFO] - Instantiating trainer <lightning.Trainer>
[2024-12-03 19:08:57,343][__main__][INFO] - Logging hyperparameters!
[2024-12-03 19:08:57,909][__main__][INFO] - Starting training!
[2024-12-03 19:27:13,467][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 574, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 981, in _run
    results = self._run_stage()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 1025, in _run_stage
    self.fit_loop.run()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\loops\fit_loop.py", line 206, in run
    self.on_advance_end()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\loops\fit_loop.py", line 392, in on_advance_end
    trainer._logger_connector.update_train_epoch_metrics()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\connectors\logger_connector\logger_connector.py", line 168, in update_train_epoch_metrics
    self.log_metrics(self.metrics["log"])
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\connectors\logger_connector\logger_connector.py", line 118, in log_metrics
    logger.save()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning_utilities\core\rank_zero.py", line 42, in wrapped_fn
    return fn(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\fabric\loggers\csv_logs.py", line 160, in save
    self.experiment.save()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\loggers\csv_logs.py", line 66, in save
    return super().save()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\fabric\loggers\csv_logs.py", line 240, in save
    with self._fs.open(self.metrics_file_path, mode=("a" if file_exists else "w"), newline="") as file:
  File "D:\anaconda3\envs\myenv\lib\site-packages\fsspec\spec.py", line 1283, in open
    self.open(
  File "D:\anaconda3\envs\myenv\lib\site-packages\fsspec\spec.py", line 1295, in open
    f = self._open(
  File "D:\anaconda3\envs\myenv\lib\site-packages\fsspec\implementations\local.py", line 180, in _open
    return LocalFileOpener(path, mode, fs=self, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\fsspec\implementations\local.py", line 302, in __init__
    self._open()
  File "D:\anaconda3\envs\myenv\lib\site-packages\fsspec\implementations\local.py", line 307, in _open
    self.f = open(self.path, mode=self.mode)
PermissionError: [Errno 13] Permission denied: 'D:/PyCharmProjects/improved_sfda/logs/OfficeHome_Ar/runs/2024-12-03_19-08-44-619547/csv/version_0/metrics.csv'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 85, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 538, in fit
    call._call_and_handle_interrupt(
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\call.py", line 67, in _call_and_handle_interrupt
    _interrupt(trainer, exception)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\trainer\call.py", line 81, in _interrupt
    logger.finalize("failed")
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning_utilities\core\rank_zero.py", line 42, in wrapped_fn
    return fn(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\fabric\loggers\csv_logs.py", line 169, in finalize
    self.save()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning_utilities\core\rank_zero.py", line 42, in wrapped_fn
    return fn(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\fabric\loggers\csv_logs.py", line 160, in save
    self.experiment.save()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\pytorch\loggers\csv_logs.py", line 66, in save
    return super().save()
  File "D:\anaconda3\envs\myenv\lib\site-packages\lightning\fabric\loggers\csv_logs.py", line 240, in save
    with self._fs.open(self.metrics_file_path, mode=("a" if file_exists else "w"), newline="") as file:
  File "D:\anaconda3\envs\myenv\lib\site-packages\fsspec\spec.py", line 1283, in open
    self.open(
  File "D:\anaconda3\envs\myenv\lib\site-packages\fsspec\spec.py", line 1295, in open
    f = self._open(
  File "D:\anaconda3\envs\myenv\lib\site-packages\fsspec\implementations\local.py", line 180, in _open
    return LocalFileOpener(path, mode, fs=self, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\fsspec\implementations\local.py", line 302, in __init__
    self._open()
  File "D:\anaconda3\envs\myenv\lib\site-packages\fsspec\implementations\local.py", line 307, in _open
    self.f = open(self.path, mode=self.mode)
PermissionError: [Errno 13] Permission denied: 'D:/PyCharmProjects/improved_sfda/logs/OfficeHome_Ar/runs/2024-12-03_19-08-44-619547/csv/version_0/metrics.csv'
[2024-12-03 19:27:13,590][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_19-08-44-619547
[2024-12-03 19:27:13,590][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 19:27:42,080][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 19:27:42,089][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 19:27:42,215][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 19:27:46,442][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-03 19:27:47,356][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-03 19:27:57,384][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-03 19:27:57,505][__main__][INFO] - Instantiating callbacks...
[2024-12-03 19:27:57,505][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-12-03 19:27:57,509][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-12-03 19:27:57,510][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-12-03 19:27:57,511][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-12-03 19:27:57,512][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.LearningRateMonitor>
[2024-12-03 19:27:57,513][__main__][INFO] - Instantiating loggers...
[2024-12-03 19:27:57,513][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-12-03 19:27:57,515][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.mlflow.MLFlowLogger>
[2024-12-03 19:27:58,790][__main__][INFO] - Instantiating trainer <lightning.Trainer>
[2024-12-03 19:27:58,869][__main__][INFO] - Logging hyperparameters!
[2024-12-03 19:27:59,524][__main__][INFO] - Starting training!
[2024-12-03 20:06:35,745][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 20:06:35,753][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 20:06:35,936][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-03 20:06:40,211][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-03 20:06:41,055][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-03 20:06:42,000][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-03 20:06:42,125][__main__][INFO] - Instantiating callbacks...
[2024-12-03 20:06:42,125][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-12-03 20:06:42,130][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-12-03 20:06:42,131][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-12-03 20:06:42,132][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-12-03 20:06:42,133][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.LearningRateMonitor>
[2024-12-03 20:06:42,134][__main__][INFO] - Instantiating loggers...
[2024-12-03 20:06:42,134][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-12-03 20:06:42,135][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.mlflow.MLFlowLogger>
[2024-12-03 20:06:43,463][__main__][INFO] - Instantiating trainer <lightning.Trainer>
[2024-12-03 20:06:43,545][__main__][INFO] - Logging hyperparameters!
[2024-12-03 20:06:44,279][__main__][INFO] - Starting training!
[2024-12-03 20:57:59,601][__main__][INFO] - Starting testing!
[2024-12-03 20:58:23,732][__main__][INFO] - Best ckpt path: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_20-06-35-705301\checkpoints\epoch_022.ckpt
[2024-12-03 20:58:23,732][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar\runs\2024-12-03_20-06-35-705301
[2024-12-03 20:58:23,733][src.utils.utils][INFO] - Closing loggers...
[2024-12-03 20:58:23,743][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-12-03 21:14:10,535][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-03 21:14:10,542][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-03 21:14:10,630][__main__][INFO] - Instantiating datamodule <src.data.tgt_train_datamodule.TgtTrainDataModule>
[2024-12-03 21:14:10,661][__main__][INFO] - Instantiating model <src.models.ours_pb_ta_directed_module.OursPBTADirectedLitModule>
[2024-12-03 21:14:14,136][matplotlib.font_manager][INFO] - generated new fontManager
[2024-12-03 21:14:15,743][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-03 21:14:16,630][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-03 21:14:17,063][__main__][INFO] - Instantiating callbacks...
[2024-12-03 21:14:17,064][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-12-03 21:14:17,067][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-12-03 21:14:17,068][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-12-03 21:14:17,069][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-12-03 21:14:17,070][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.LearningRateMonitor>
[2024-12-03 21:14:17,071][__main__][INFO] - Instantiating loggers...
[2024-12-03 21:14:17,072][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-12-03 21:14:17,073][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.mlflow.MLFlowLogger>
[2024-12-03 21:14:17,707][__main__][INFO] - Instantiating trainer <lightning.Trainer>
[2024-12-03 21:14:17,728][__main__][INFO] - Logging hyperparameters!
[2024-12-03 21:14:17,959][__main__][INFO] - Starting training!
[2024-12-04 02:49:33,880][__main__][INFO] - Starting testing!
[2024-12-04 02:50:01,723][__main__][INFO] - Best ckpt path: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar2Cl\runs\2024-12-03_21-14-10-496504\checkpoints\epoch_130.ckpt
[2024-12-04 02:50:01,724][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\OfficeHome_Ar2Cl\runs\2024-12-03_21-14-10-496504
[2024-12-04 02:50:01,724][src.utils.utils][INFO] - Closing loggers...
[2024-12-04 02:50:01,725][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-12-04 09:33:26,943][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-04 09:33:26,950][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-04 09:33:27,069][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-04 09:33:28,113][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "D:\PyCharmProjects\improved_sfda\src\data\components\site.py", line 52, in __init__
    assert task in self.image_list
AssertionError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 56, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.data.components.site.Site':
AssertionError()
full_key: data.dataset
[2024-12-04 09:33:28,122][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\site_baoding\runs\2024-12-04_09-33-26-907674
[2024-12-04 09:33:28,123][src.utils.utils][INFO] - Closing loggers...
[2024-12-04 09:35:25,877][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-04 09:35:25,883][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-04 09:35:25,965][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-04 09:35:26,646][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-04 09:35:27,424][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-04 09:35:28,023][src.utils.utils][ERROR] - 
urllib3.exceptions.SSLError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\requests\adapters.py", line 667, in send
    resp = conn.urlopen(
  File "D:\anaconda3\envs\myenv\lib\site-packages\urllib3\connectionpool.py", line 843, in urlopen
    retries = retries.increment(
  File "D:\anaconda3\envs\myenv\lib\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /timm/resnet50.tv_in1k/resolve/main/model.safetensors (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\timm\models\_factory.py", line 117, in create_model
    model = create_fn(
  File "D:\anaconda3\envs\myenv\lib\site-packages\timm\models\_registry.py", line 145, in _fn
    return current_fn(pretrained=pretrained, pretrained_cfg=pretrained_cfg or current_tag, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\timm\models\resnet.py", line 1390, in resnet50
    return _create_resnet('resnet50', pretrained, **dict(model_args, **kwargs))
  File "D:\anaconda3\envs\myenv\lib\site-packages\timm\models\resnet.py", line 642, in _create_resnet
    return build_model_with_cfg(ResNet, variant, pretrained, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\timm\models\_builder.py", line 427, in build_model_with_cfg
    load_pretrained(
  File "D:\anaconda3\envs\myenv\lib\site-packages\timm\models\_builder.py", line 205, in load_pretrained
    state_dict = load_state_dict_from_hf(pretrained_loc, weights_only=True)
  File "D:\anaconda3\envs\myenv\lib\site-packages\timm\models\_hub.py", line 183, in load_state_dict_from_hf
    cached_safe_file = hf_hub_download(repo_id=hf_model_id, filename=safe_filename, revision=hf_revision)
  File "D:\anaconda3\envs\myenv\lib\site-packages\huggingface_hub\utils\_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\huggingface_hub\file_download.py", line 862, in hf_hub_download
    return _hf_hub_download_to_cache_dir(
  File "D:\anaconda3\envs\myenv\lib\site-packages\huggingface_hub\file_download.py", line 925, in _hf_hub_download_to_cache_dir
    (url_to_download, etag, commit_hash, expected_size, head_call_error) = _get_metadata_or_catch_error(
  File "D:\anaconda3\envs\myenv\lib\site-packages\huggingface_hub\file_download.py", line 1376, in _get_metadata_or_catch_error
    metadata = get_hf_file_metadata(
  File "D:\anaconda3\envs\myenv\lib\site-packages\huggingface_hub\utils\_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\huggingface_hub\file_download.py", line 1296, in get_hf_file_metadata
    r = _request_wrapper(
  File "D:\anaconda3\envs\myenv\lib\site-packages\huggingface_hub\file_download.py", line 277, in _request_wrapper
    response = _request_wrapper(
  File "D:\anaconda3\envs\myenv\lib\site-packages\huggingface_hub\file_download.py", line 300, in _request_wrapper
    response = get_session().request(method=method, url=url, **params)
  File "D:\anaconda3\envs\myenv\lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\huggingface_hub\utils\_http.py", line 93, in send
    return super().send(request, *args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\requests\adapters.py", line 698, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: (MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /timm/resnet50.tv_in1k/resolve/main/model.safetensors (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))"), '(Request ID: 646e85b7-d49f-48f9-9c6b-88610a8ce157)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 59, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'timm.models._factory.create_model':
SSLError(MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /timm/resnet50.tv_in1k/resolve/main/model.safetensors (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))"), '(Request ID: 646e85b7-d49f-48f9-9c6b-88610a8ce157)')
full_key: model.net.backbone
[2024-12-04 09:35:28,146][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\site_baoding\runs\2024-12-04_09-35-25-841189
[2024-12-04 09:35:28,147][src.utils.utils][INFO] - Closing loggers...
[2024-12-04 09:36:05,672][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-04 09:36:05,679][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-04 09:36:05,764][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-04 09:36:06,437][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-04 09:36:06,944][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-04 09:36:16,960][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-04 09:36:17,127][__main__][INFO] - Instantiating callbacks...
[2024-12-04 09:36:17,128][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-12-04 09:36:17,131][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-12-04 09:36:17,133][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-12-04 09:36:17,133][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-12-04 09:36:17,135][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.LearningRateMonitor>
[2024-12-04 09:36:17,136][__main__][INFO] - Instantiating loggers...
[2024-12-04 09:36:17,136][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-12-04 09:36:17,140][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.mlflow.MLFlowLogger>
[2024-12-04 09:36:17,744][__main__][INFO] - Instantiating trainer <lightning.Trainer>
[2024-12-04 09:36:17,820][__main__][INFO] - Logging hyperparameters!
[2024-12-04 09:36:18,417][__main__][INFO] - Starting training!
[2024-12-04 10:20:22,770][__main__][INFO] - Starting testing!
[2024-12-04 10:20:49,665][__main__][INFO] - Best ckpt path: D:\PyCharmProjects\improved_sfda\logs\site_baoding\runs\2024-12-04_09-36-05-637662\checkpoints\epoch_018.ckpt
[2024-12-04 10:20:49,666][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\site_baoding\runs\2024-12-04_09-36-05-637662
[2024-12-04 10:20:49,666][src.utils.utils][INFO] - Closing loggers...
[2024-12-04 10:20:49,667][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-12-04 10:29:54,309][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-04 10:29:54,317][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-04 10:29:54,406][__main__][INFO] - Instantiating datamodule <src.data.tgt_train_datamodule.TgtTrainDataModule>
[2024-12-04 10:29:54,430][__main__][INFO] - Instantiating model <src.models.ours_pb_ta_directed_module.OursPBTADirectedLitModule>
[2024-12-04 10:29:57,421][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-04 10:30:07,437][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-04 10:30:07,914][__main__][INFO] - Instantiating callbacks...
[2024-12-04 10:30:07,914][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-12-04 10:30:07,918][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-12-04 10:30:07,919][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-12-04 10:30:07,920][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-12-04 10:30:07,921][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.LearningRateMonitor>
[2024-12-04 10:30:07,921][__main__][INFO] - Instantiating loggers...
[2024-12-04 10:30:07,922][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-12-04 10:30:07,924][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.mlflow.MLFlowLogger>
[2024-12-04 10:30:08,546][__main__][INFO] - Instantiating trainer <lightning.Trainer>
[2024-12-04 10:30:08,575][__main__][INFO] - Logging hyperparameters!
[2024-12-04 10:30:08,815][__main__][INFO] - Starting training!
[2024-12-04 13:59:54,931][__main__][INFO] - Starting testing!
[2024-12-04 14:00:31,235][__main__][INFO] - Best ckpt path: D:\PyCharmProjects\improved_sfda\logs\Site_baoding2tianjin\runs\2024-12-04_10-29-54-270388\checkpoints\epoch_000.ckpt
[2024-12-04 14:00:31,236][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\Site_baoding2tianjin\runs\2024-12-04_10-29-54-270388
[2024-12-04 14:00:31,236][src.utils.utils][INFO] - Closing loggers...
[2024-12-04 14:00:31,237][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-12-04 14:09:24,770][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-04 14:09:24,779][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-04 14:09:24,916][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-04 14:09:26,107][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-04 14:09:26,968][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-04 14:09:27,567][src.utils.utils][ERROR] - 
urllib3.exceptions.SSLError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\requests\adapters.py", line 667, in send
    resp = conn.urlopen(
  File "D:\anaconda3\envs\myenv\lib\site-packages\urllib3\connectionpool.py", line 843, in urlopen
    retries = retries.increment(
  File "D:\anaconda3\envs\myenv\lib\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /timm/resnet50.tv_in1k/resolve/main/model.safetensors (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\timm\models\_factory.py", line 117, in create_model
    model = create_fn(
  File "D:\anaconda3\envs\myenv\lib\site-packages\timm\models\_registry.py", line 145, in _fn
    return current_fn(pretrained=pretrained, pretrained_cfg=pretrained_cfg or current_tag, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\timm\models\resnet.py", line 1390, in resnet50
    return _create_resnet('resnet50', pretrained, **dict(model_args, **kwargs))
  File "D:\anaconda3\envs\myenv\lib\site-packages\timm\models\resnet.py", line 642, in _create_resnet
    return build_model_with_cfg(ResNet, variant, pretrained, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\timm\models\_builder.py", line 427, in build_model_with_cfg
    load_pretrained(
  File "D:\anaconda3\envs\myenv\lib\site-packages\timm\models\_builder.py", line 205, in load_pretrained
    state_dict = load_state_dict_from_hf(pretrained_loc, weights_only=True)
  File "D:\anaconda3\envs\myenv\lib\site-packages\timm\models\_hub.py", line 183, in load_state_dict_from_hf
    cached_safe_file = hf_hub_download(repo_id=hf_model_id, filename=safe_filename, revision=hf_revision)
  File "D:\anaconda3\envs\myenv\lib\site-packages\huggingface_hub\utils\_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\huggingface_hub\file_download.py", line 862, in hf_hub_download
    return _hf_hub_download_to_cache_dir(
  File "D:\anaconda3\envs\myenv\lib\site-packages\huggingface_hub\file_download.py", line 925, in _hf_hub_download_to_cache_dir
    (url_to_download, etag, commit_hash, expected_size, head_call_error) = _get_metadata_or_catch_error(
  File "D:\anaconda3\envs\myenv\lib\site-packages\huggingface_hub\file_download.py", line 1376, in _get_metadata_or_catch_error
    metadata = get_hf_file_metadata(
  File "D:\anaconda3\envs\myenv\lib\site-packages\huggingface_hub\utils\_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\huggingface_hub\file_download.py", line 1296, in get_hf_file_metadata
    r = _request_wrapper(
  File "D:\anaconda3\envs\myenv\lib\site-packages\huggingface_hub\file_download.py", line 277, in _request_wrapper
    response = _request_wrapper(
  File "D:\anaconda3\envs\myenv\lib\site-packages\huggingface_hub\file_download.py", line 300, in _request_wrapper
    response = get_session().request(method=method, url=url, **params)
  File "D:\anaconda3\envs\myenv\lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\huggingface_hub\utils\_http.py", line 93, in send
    return super().send(request, *args, **kwargs)
  File "D:\anaconda3\envs\myenv\lib\site-packages\requests\adapters.py", line 698, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: (MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /timm/resnet50.tv_in1k/resolve/main/model.safetensors (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))"), '(Request ID: 6e087f8f-af25-4aaf-b0a6-bb0288c2911f)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\PyCharmProjects\improved_sfda\src\utils\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "D:\PyCharmProjects\improved_sfda\src\train.py", line 59, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "D:\anaconda3\envs\myenv\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'timm.models._factory.create_model':
SSLError(MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /timm/resnet50.tv_in1k/resolve/main/model.safetensors (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1007)')))"), '(Request ID: 6e087f8f-af25-4aaf-b0a6-bb0288c2911f)')
full_key: model.net.backbone
[2024-12-04 14:09:27,711][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\site_tianjin\runs\2024-12-04_14-09-24-733572
[2024-12-04 14:09:27,711][src.utils.utils][INFO] - Closing loggers...
[2024-12-04 14:09:42,706][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-04 14:09:42,713][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-04 14:09:42,791][__main__][INFO] - Instantiating datamodule <src.data.src_train_datamodule.SrcTrainDataModule>
[2024-12-04 14:09:43,514][__main__][INFO] - Instantiating model <src.models.basic_module.BasicLitModule>
[2024-12-04 14:09:44,052][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-04 14:09:54,101][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-04 14:09:54,221][__main__][INFO] - Instantiating callbacks...
[2024-12-04 14:09:54,221][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-12-04 14:09:54,225][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-12-04 14:09:54,226][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-12-04 14:09:54,227][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-12-04 14:09:54,228][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.LearningRateMonitor>
[2024-12-04 14:09:54,229][__main__][INFO] - Instantiating loggers...
[2024-12-04 14:09:54,229][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-12-04 14:09:54,231][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.mlflow.MLFlowLogger>
[2024-12-04 14:09:54,811][__main__][INFO] - Instantiating trainer <lightning.Trainer>
[2024-12-04 14:09:54,902][__main__][INFO] - Logging hyperparameters!
[2024-12-04 14:09:55,555][__main__][INFO] - Starting training!
[2024-12-04 14:56:31,757][__main__][INFO] - Starting testing!
[2024-12-04 14:57:05,531][__main__][INFO] - Best ckpt path: D:\PyCharmProjects\improved_sfda\logs\site_tianjin\runs\2024-12-04_14-09-42-669802\checkpoints\epoch_048.ckpt
[2024-12-04 14:57:05,532][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\site_tianjin\runs\2024-12-04_14-09-42-669802
[2024-12-04 14:57:05,533][src.utils.utils][INFO] - Closing loggers...
[2024-12-04 14:57:05,534][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-12-04 14:57:52,750][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-12-04 14:57:52,757][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-12-04 14:57:52,849][__main__][INFO] - Instantiating datamodule <src.data.tgt_train_datamodule.TgtTrainDataModule>
[2024-12-04 14:57:52,878][__main__][INFO] - Instantiating model <src.models.ours_pb_ta_directed_module.OursPBTADirectedLitModule>
[2024-12-04 14:57:55,699][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.tv_in1k)
[2024-12-04 14:58:05,710][timm.models._hub][INFO] - [timm/resnet50.tv_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-12-04 14:58:06,232][__main__][INFO] - Instantiating callbacks...
[2024-12-04 14:58:06,233][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-12-04 14:58:06,236][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-12-04 14:58:06,238][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-12-04 14:58:06,238][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-12-04 14:58:06,239][src.utils.utils][INFO] - Instantiating callback <lightning.pytorch.callbacks.LearningRateMonitor>
[2024-12-04 14:58:06,240][__main__][INFO] - Instantiating loggers...
[2024-12-04 14:58:06,240][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-12-04 14:58:06,242][src.utils.utils][INFO] - Instantiating logger <lightning.pytorch.loggers.mlflow.MLFlowLogger>
[2024-12-04 14:58:06,776][__main__][INFO] - Instantiating trainer <lightning.Trainer>
[2024-12-04 14:58:06,799][__main__][INFO] - Logging hyperparameters!
[2024-12-04 14:58:07,044][__main__][INFO] - Starting training!
[2024-12-04 17:40:50,596][__main__][INFO] - Starting testing!
[2024-12-04 17:41:15,324][__main__][INFO] - Best ckpt path: D:\PyCharmProjects\improved_sfda\logs\Site_tianjin2baoding\runs\2024-12-04_14-57-52-711361\checkpoints\epoch_000.ckpt
[2024-12-04 17:41:15,325][src.utils.utils][INFO] - Output dir: D:\PyCharmProjects\improved_sfda\logs\Site_tianjin2baoding\runs\2024-12-04_14-57-52-711361
[2024-12-04 17:41:15,325][src.utils.utils][INFO] - Closing loggers...
[2024-12-04 17:41:15,326][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
